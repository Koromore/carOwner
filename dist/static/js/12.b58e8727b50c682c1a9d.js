webpackJsonp([12],{YnZU:function(e,t){},yUvI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("BO1k"),l=a.n(s),i=a("/vms"),c={name:"ownersschedule",components:{},data:function(){return{num:[1],ownerId:this.$route.params.id,newDate:new Date,scheduleRecord:!1,ownerScheduleListData:[],input:"",value1:"",input3:"",addSchedule:!1,prepend:"1",select:"",options:[],value:"",dayTypeListData:[],optionsCity:i.a,district:"",district_code:"",drawerLoading:!1,schName:"",tiemQuan:"",startTime:"",endTime:"",during:"",duringType:"",dayTypeId:"",schLine:"",carTypeId:"",remark:"",deptId:"",schNum:"",preEditSchedule:"",deptIdList:[{value:105,label:"沃尔沃"},{value:110,label:"吉利"},{value:153,label:"长城"}],carTypeIdList:[]}},watch:{},beforeCreate:function(){},beforeMount:function(){},mounted:function(){console.log(this.$route.params.id),this.getOwnerScheduleList(),this.getDayTypeList(),this.getCarSeriesLists()},methods:{previous:function(){this.$router.push({path:"/home/owners"})},getCascaderObj:function(e,t){return e.map(function(e,a,s){var i=!0,c=!1,r=void 0;try{for(var n,o=l()(t);!(i=(n=o.next()).done);i=!0){var d=n.value;if(d.value==e)return t=d.children,d}}catch(e){c=!0,r=e}finally{try{!i&&o.return&&o.return()}finally{if(c)throw r}}return null})},handleChangeCity:function(e,t){for(var a=this.getCascaderObj(e,this.optionsCity),s=[],l=0;l<a.length;l++)s.push(a[l].label);this.district=s,console.log(s),console.log(e)},getOwnerScheduleList:function(){var e=this,t={vehicleOwnerId:this.ownerId};this.$axios.post("/ocarplay/api/vehicleOwner/ownerScheduleListAjax",t).then(function(t){if(console.log(t),200==t.status){var a=t.data;a.items.forEach(function(e){e.startGetTime=new Date(e.startTime.replace(/-/g,"/")).getTime(),e.endGetTime=new Date(e.endTime.replace(/-/g,"/")).getTime()+576e5}),e.ownerScheduleListData=a.items,console.log(e.ownerScheduleListData)}})},getDayTypeList:function(){var e=this;this.$axios.post("/ocarplay/api/dayType/listAjaxUnPage",{ids:0,pageNum:1,pageSize:100}).then(function(t){if(200==t.status){var a=[];t.data.forEach(function(e){a.push({value:e.dayTypeId,label:e.dayTypeName})}),e.dayTypeListData=a}})},getCarSeriesLists:function(){var e=this;this.$axios.post("/ocarplay/api/carType/getCarTypes",{ids:0,pageNum:1,pageSize:30}).then(function(t){if(200==t.status){var a=[];t.data.data.forEach(function(e){a.push({value:e.carTypeId,label:e.carTypeName})}),e.carTypeIdList=a}})},saveOwnerSchedule:function(){var e=this;this.drawerLoading=!0;var t=this.district,a={ownerId:this.ownerId,schName:this.schName,startTime:this.$date0(this.tiemQuan[0]),endTime:this.$date0(this.tiemQuan[1]),during:this.during,duringType:this.duringType,dayTypeId:this.dayTypeId,schLine:this.schLine,remark:this.remark};2==t.length?(a.province="",a.city=this.district[0],a.area=this.district[1]):(a.province=this.district[0],a.city=this.district[1],a.area=this.district[2]),this.$axios.post("/ocarplay/api/schedule/saveOrUpdate",a).then(function(t){console.log(t),200==t.status&&0==t.data.errcode?(e.$message.success(t.data.msg),e.drawerLoading=!1,e.addSchedule=!1,e.getOwnerScheduleList()):e.$message.error(t.data.msg)})},schedulePlaceOrder:function(){var e=this;this.drawerLoading=!0;this.district;var t={schId:this.preEditSchedule.schId,deptId:this.deptId,carTypeId:this.carTypeId,schNum:this.schNum};this.$axios.post("/ocarplay/api/schedule/placeOrder",t).then(function(t){console.log(t),200==t.status?(e.$message.success(t.data.msg),e.drawerLoading=!1,e.scheduleRecord=!1,e.getOwnerScheduleList()):e.$message.error(t.data.msg)})},submit:function(){var e=this;this.$confirm("确认提交任务吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$message({type:"success",message:"提交成功!"})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},changeSize:function(e){console.log(e)},changePage:function(e){console.log(e)},openAddSchedule:function(){this.addSchedule=!0},scheduleDetail:function(e){var t=this;this.scheduleRecord=!0;var a={schId:e};this.$axios.post("/ocarplay/api/schedule/preEditSchedule",a).then(function(e){if(console.log(e),200==e.status){var a=e.data;t.preEditSchedule=a}})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"ownersschedule"}},[a("el-row",{staticClass:"top"},[a("el-col",{staticClass:"left cont",attrs:{span:8}},[a("div",{on:{click:e.previous}},[a("i",{staticClass:"el-icon-arrow-left"}),e._v("\n        返回\n      ")])]),e._v(" "),a("el-col",{staticClass:"center cont",attrs:{span:8}},[e._v("日程管理")]),e._v(" "),a("el-col",{staticClass:"right cont",attrs:{span:8}})],1),e._v(" "),a("el-row",{staticClass:"content"},[a("el-col",{staticClass:"openAddBox",attrs:{sapn:24}},[a("div",{staticClass:"openAdd",on:{click:e.openAddSchedule}},[e._v("新建日程")])]),e._v(" "),a("el-calendar",{scopedSlots:e._u([{key:"dateCell",fn:function(t){var s=t.date,l=t.data;return[a("div",{class:l.isSelected?"is-selected box":"box"},[a("div",{staticClass:"time"},[e._v(e._s(l.day.split("-").slice(1).join("-"))+" "+e._s(l.isSelected?"✔️":""))]),e._v(" "),e._l(e.ownerScheduleListData,function(t,l){return t.startGetTime<=s.getTime()&&t.endGetTime>=s.getTime()?a("div",{key:l,staticClass:"schedule",on:{click:function(a){return e.scheduleDetail(t.schId)}}},[e._v("\n            "+e._s(t.schName)+"\n            ")]):e._e()})],2)]}}])})],1),e._v(" "),a("el-drawer",{attrs:{title:"日程预约",visible:e.scheduleRecord,size:"572px"},on:{"update:visible":function(t){e.scheduleRecord=t}}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],staticClass:"scheduleRecord"},[a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("任务名称")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v(e._s(e.preEditSchedule.schName))]),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("开始时间")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v(e._s(e.preEditSchedule.startTime))]),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("时长")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v("\n        "+e._s(e.preEditSchedule.during)+"\n        "),0==e.preEditSchedule.duringType||0==e.preEditSchedule.duringType?[e._v("小时")]:e._e(),e._v(" "),1==e.preEditSchedule.duringType||1==e.preEditSchedule.duringType?[e._v("天")]:e._e(),e._v(" "),2==e.preEditSchedule.duringType?[e._v("月")]:e._e()],2),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("类型")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v(e._s(e.preEditSchedule.dayTypeName))]),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("路线")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v(e._s(e.preEditSchedule.schLine))]),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("地点")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v(e._s(e.preEditSchedule.province)+e._s(e.preEditSchedule.city)+e._s(e.preEditSchedule.area))]),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("备注")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:19}},[e._v(e._s(e.preEditSchedule.remark))]),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("预约车主")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{staticClass:"appoin",attrs:{span:19}},[a("el-col",{attrs:{span:7}},[a("el-select",{attrs:{clearable:"",placeholder:"预约组别"},model:{value:e.deptId,callback:function(t){e.deptId=t},expression:"deptId"}},e._l(e.deptIdList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("el-select",{attrs:{clearable:"",placeholder:"预约车型"},model:{value:e.carTypeId,callback:function(t){e.carTypeId=t},expression:"carTypeId"}},e._l(e.carTypeIdList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"计划预约量",clearable:""},model:{value:e.schNum,callback:function(t){e.schNum=t},expression:"schNum"}})],1)],1),e._v(" "),a("el-col",{staticClass:"btn",attrs:{span:24}},[a("el-col",{attrs:{span:8,offset:3}},[a("el-button",{attrs:{type:"info"}},[e._v("取消")])],1),e._v(" "),a("el-col",{attrs:{span:8,offset:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.schedulePlaceOrder}},[e._v("下单预约")])],1)],1)],1)],1),e._v(" "),a("el-drawer",{attrs:{title:"新建日程",visible:e.addSchedule,size:"572px"},on:{"update:visible":function(t){e.addSchedule=t}}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.drawerLoading,expression:"drawerLoading"}],staticClass:"addSchedule"},[a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("日程主题")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.schName,callback:function(t){e.schName=t},expression:"schName"}})],1),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("开始时间")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.tiemQuan,callback:function(t){e.tiemQuan=t},expression:"tiemQuan"}})],1),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("时长")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.during,callback:function(t){e.during=t},expression:"during"}},[a("el-select",{attrs:{slot:"append",placeholder:"选择"},slot:"append",model:{value:e.duringType,callback:function(t){e.duringType=t},expression:"duringType"}},[a("el-option",{attrs:{label:"时",value:0}}),e._v(" "),a("el-option",{attrs:{label:"天",value:1}}),e._v(" "),a("el-option",{attrs:{label:"月",value:2}})],1)],1)],1),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("类型")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dayTypeId,callback:function(t){e.dayTypeId=t},expression:"dayTypeId"}},e._l(e.dayTypeListData,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("路线")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.schLine,callback:function(t){e.schLine=t},expression:"schLine"}})],1),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("地点")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-cascader",{ref:"cascaderAddr",attrs:{options:e.optionsCity,filterable:"",clearable:"",placeholder:"请选择所在区域"},on:{change:e.handleChangeCity},model:{value:e.district_code,callback:function(t){e.district_code=t},expression:"district_code"}})],1),e._v(" "),a("el-col",{staticClass:"key",attrs:{span:4}},[e._v("备注")]),e._v(" "),a("el-col",{attrs:{span:1}},[e._v(":")]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1),e._v(" "),a("el-col",{staticClass:"btn",attrs:{span:24}},[a("el-col",{attrs:{span:8,offset:3}},[a("el-button",{attrs:{type:"info"}},[e._v("取消")])],1),e._v(" "),a("el-col",{attrs:{span:8,offset:3}},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveOwnerSchedule}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(c,r,!1,function(e){a("YnZU")},"data-v-7ee9ab91",null);t.default=n.exports}});