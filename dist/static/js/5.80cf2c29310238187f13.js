webpackJsonp([5],{K88i:function(t,s){},qAdC:function(t,s){},zrp1:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("bOdI"),i=e.n(a),l={name:"addTask",components:{},data:function(){var t;return t={userId:this.$store.state.user.userId,deptId:this.$store.state.user.deptId,taskId:"",type:0,title:"新建任务",options2:[],input:"",input1:"",input2:"",textarea:"",props:{multiple:!0},carSeriesList:[],input3:"",options:[{value:"选项1",label:"黄金糕"},{value:"选项2",label:"双皮奶"},{value:"选项3",label:"蚵仔煎"},{value:"选项4",label:"龙须面"},{value:"选项5",label:"北京烤鸭"}],input4:"",input5:"",fileList:[],taskName:"",listInviteList:[]},i()(t,"carSeriesList",[]),i()(t,"carSeriesId",[]),i()(t,"periodTime",[]),i()(t,"taskNum",""),i()(t,"listTaskFile",[]),i()(t,"taskDesc",""),i()(t,"remark",""),i()(t,"taskFileList",""),i()(t,"submitFlag",!0),i()(t,"putLoading",!1),t},watch:{},beforeCreate:function(){},beforeMount:function(){},mounted:function(){this.getQuery(),this.getCarSeriesLists(),this.getOwnerList()},methods:{getQuery:function(){var t=this.$route.query.type,s=this.$route.query.id;this.type=t,0==t?(this.title="新建任务",this.taskId=""):1==t&&(this.title="编辑任务",this.taskId=s,this.getTaskDetail(s))},getTaskDetail:function(t){var s=this,e={taskId:t};this.$axios.post("/ocarplay/task/edit",e).then(function(t){if(console.log(t),200==t.status){var e=t.data;s.taskName=e.taskName}})},getOwnerList:function(){var t=this;this.$axios.post("/ocarplay/api/vehicleOwner/ownerTypeCoopItemOwners",{}).then(function(s){if(200==s.status){var e=[];s.data.forEach(function(t,s){e.push({value:t.typeId,label:t.typeName,children:[]}),t.ownerItems.forEach(function(t,a){e[s].children.push({value:t.itemId,label:t.itemName,children:[]}),t.vehicleOwners.forEach(function(t){e[s].children[a].children.push({value:t.vehicleOwnerId,label:t.name})})})}),t.options2=e}})},getCarSeriesLists:function(){var t=this;this.$axios.post("/ocarplay/api/carSeries/getCarSeriesLists",{ids:0,pageNum:1,pageSize:30}).then(function(s){if(200==s.status){var e=[{value:105,label:"沃尔沃",children:[]},{value:110,label:"吉利舆情",children:[]},{value:153,label:"长城",children:[]}];s.data.items.forEach(function(t){var s={value:t.carTypeId,label:t.carTypeName,children:[]},a=t.carSeriesIds.split("/"),i=t.carSeriesName.split("/");a.forEach(function(t,e){s.children.push({value:1*t,label:i[e]})}),105==t.deptId?e[0].children.push(s):110==t.deptId?e[1].children.push(s):153==t.deptId&&e[2].children.push(s)}),t.carSeriesList=e}})},previous:function(){this.$router.push({path:"/home/task"})},taskFileSuccess:function(t,s,e){var a=[];e.forEach(function(t){a.push(t.response.data)}),this.taskFileList=a},taskFileRemove:function(t,s){var e=[];s.forEach(function(t){e.push(t.response.data)}),this.taskFileList=e},beforeRemove:function(t,s){return this.$confirm("确定移除 "+t.name+"？")},saveTask:function(){var t=this,s=this.periodTime,e="",a="";0!=s.length&&(e=this.$date0(s[0]),a=this.$date0(s[1]));var i=this.listInviteList,l={initUserId:this.userId,deptId:this.deptId,createTime:this.$time0(new Date),taskName:this.taskName,status:0,startTime:e,endTime:a,num:this.taskNum,carSeriesId:this.carSeriesId[2],taskDesc:this.taskDesc,remark:this.remark,listInvite:[],listTaskFile:this.taskFileList};i.forEach(function(t){l.listInvite.push({typeId:t[0],itemId:t[1],ownerId:t[2]})});var r=!0;[l.taskName,l.startTime,l.num,l.carSeriesId,l.taskDesc,l.remark,l.listInvite.length,l.listTaskFile.length].forEach(function(t){t||(r=!1)}),console.log(l),r?(this.putLoading=!0,this.$axios.post("/ocarplay/task/save",l).then(function(s){200==s.status&&1==s.data?(t.$message.success("任务新建成功！"),setTimeout(function(){t.$router.push({name:"task"})},1e3)):(t.$message.error("任务新建失败！"),t.putLoading=!1)}).catch(function(s){console.log(s),t.putLoading=!1})):this.$message.error("请检查信息是否填写完整！")},messageWin:function(t){this.$message({message:t,type:"success"})},messageWarning:function(t){this.$message({message:t,type:"warning"})},messageError:function(t){this.$message.error(t)}}},r={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"addTask"}},[e("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.putLoading,expression:"putLoading"}],staticClass:"content"},[e("el-col",{staticClass:"title",attrs:{span:24}},[e("el-col",{staticClass:"previousBox",attrs:{span:6}},[e("div",{on:{click:t.previous}},[e("i",{staticClass:"el-icon-arrow-left"}),t._v("\n          返回\n        ")])]),t._v(" "),e("el-col",{attrs:{span:12}},[t._v(t._s(t.title))])],1),t._v(" "),e("el-col",{staticClass:"left",attrs:{span:12}},[e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("任务名称")]),t._v(" "),e("div",{staticClass:"val"},[e("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.taskName,callback:function(s){t.taskName=s},expression:"taskName"}})],1)]),t._v(" "),e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("任务对象")]),t._v(" "),e("div",{staticClass:"val"},[e("el-cascader",{attrs:{options:t.options2,props:t.props,clearable:"",filterable:""},model:{value:t.listInviteList,callback:function(s){t.listInviteList=s},expression:"listInviteList"}})],1)]),t._v(" "),e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("品牌车型")]),t._v(" "),e("div",{staticClass:"val"},[e("el-cascader",{attrs:{options:t.carSeriesList,clearable:"",filterable:""},model:{value:t.carSeriesId,callback:function(s){t.carSeriesId=s},expression:"carSeriesId"}})],1)]),t._v(" "),e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("计划周期")]),t._v(" "),e("div",{staticClass:"val"},[e("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.periodTime,callback:function(s){t.periodTime=s},expression:"periodTime"}})],1)]),t._v(" "),e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("计划邀约量")]),t._v(" "),e("div",{staticClass:"val"},[e("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.taskNum,callback:function(s){t.taskNum=s},expression:"taskNum"}})],1)]),t._v(" "),e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("任务文件")]),t._v(" "),e("div",{staticClass:"val"},[e("el-upload",{staticClass:"upload-demo",attrs:{action:"/ocarplay/file/upload","on-remove":t.taskFileRemove,"on-success":t.taskFileSuccess}},[e("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})],1)],1)])],1),t._v(" "),e("el-col",{staticClass:"right",attrs:{span:12}},[e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("任务描述")]),t._v(" "),e("div",{staticClass:"val valList"},[e("el-input",{attrs:{type:"textarea",rows:7,placeholder:"请输入内容"},model:{value:t.taskDesc,callback:function(s){t.taskDesc=s},expression:"taskDesc"}})],1)]),t._v(" "),e("el-col",{staticClass:"list",attrs:{span:24}},[e("div",{staticClass:"key"},[t._v("备注")]),t._v(" "),e("div",{staticClass:"val"},[e("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:t.remark,callback:function(s){t.remark=s},expression:"remark"}})],1)])],1),t._v(" "),e("el-col",{staticClass:"put",attrs:{span:24}},[e("el-button",{attrs:{type:"primary"},on:{click:t.saveTask}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var n=e("VU/8")(l,r,!1,function(t){e("K88i"),e("qAdC")},"data-v-3a4a778e",null);s.default=n.exports}});